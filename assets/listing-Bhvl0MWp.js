import{i as T,d as D,a as y,c as w,f as C,b as k,j as $}from"./app-CAUdzOG1.js";import{g as A,p as S}from"./bid-CSiMpS3X.js";import{g as j}from"./getFromUrl-l7KgJi7t.js";async function F({id:e,_seller:r=!0,_bids:d=!0}){const t=new URL(`${T}/${e}`);r&&t.searchParams.append("_seller",r),d&&t.searchParams.append("_bids","true");try{return(await D(t)).data}catch(a){console.error("Fetching error:",a.message)}}function N(e){const r=new Date(e),d={year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return r.toLocaleString("no-NO",d).replace(",","")}function B(e){const r=e.created;return N(r)}async function P(e){const r=document.getElementById("listing-title");r.innerText=e.title;const d=document.getElementById("listing-img");A(e,d);const t=document.getElementById("listing-seller-link");t.href=`/profile/index.html?name=${e.seller.name}`,y?t.href=`/profile/index.html?name=${e.seller.name}`:(t.href="#",t.addEventListener("click",n=>{n.preventDefault(),alert("You must be logged in to view profiles.")}));const a=document.getElementById("listing-seller-avatar");a.src=e.seller?.avatar?.url,a.alt=e.seller?.avatar?.alt||e.seller?.avatar?.url;const o=document.getElementById("listing-seller");o.innerText=e.seller.name;const l=document.getElementById("listing-description");l.innerText=e.description;const f=document.getElementById("auction-expiry");f.innerText=w(e.endsAt);const i=C(e),u=document.getElementById("listing-current-bid");u.innerText=i.amount;const L=document.getElementById("listing-current-bidder");L.innerText=i.bidder.name;const m=document.getElementById("listing-current-bidder-link");if(y?m.href=`/profile/index.html?name=${i.bidder.name}`:(m.href="#",m.addEventListener("click",n=>{n.preventDefault(),alert("You must be logged in to view profiles.")})),e.bids.length<1){const n=document.getElementById("listing-no-bids");n.innerText="No bids yet!",u.innerText=""}if(e.bids.length!==0){const n=document.getElementById("listing-current-bidder-avatar");n.src=i.bidder.avatar.url,n.alt=i.bidder.avatar.alt||i.bidder.avatar.url,m.href=`/profile/index.html?name=${i.bidder.name}`;const s=document.getElementById("listing-current-bid-date");s.innerText=B(i)}else m.classList.add("hidden");const x=document.getElementById("listing-bids-container");if(e.bids.length>1){const n=document.getElementById("listing-bids-details");n.classList.remove("hidden"),n.classList.add("flex"),e.bids.forEach(s=>{const p=document.createElement("div");p.classList.add("flex","items-center","justify-between");const b=document.createElement("p");b.classList.add("font-semibold"),b.innerText=s.amount;const c=document.createElement("a");c.classList.add("flex","items-center","gap-3"),y?c.href=`/profile/index.html?name=${s.bidder.name}`:(c.href="#",c.addEventListener("click",I=>{I.preventDefault(),alert("You must be logged in to view profiles.")}));const h=document.createElement("div");h.classList.add("w-8","h-8","rounded-full","bg-gray-300","overflow-hidden");const g=document.createElement("img");g.classList.add("w-full","h-full","object-cover"),g.src=s.bidder.avatar.url,g.alt=s.bidder.avatar.alt||s.bidder.avatar.url,h.append(g);const v=document.createElement("p");v.classList.add("font-semibold"),v.innerText=s.bidder.name,c.append(h,v);const E=document.createElement("p");E.innerText=B(s),p.append(b,c,E),x.append(p)})}}async function q(){const e=document.getElementById("listing-content"),r=document.querySelector("main"),d=k();r.append(d);const t=j(),a=await F({id:t});document.title=`${a.title} | HammerPrice`,P(a);const o=document.forms.placeBid,l=$();l?l&&a.seller.name===l.name&&o.classList.add("hidden"):o.classList.add("hidden"),o.addEventListener("submit",f=>{const i=a.id,u=parseFloat(document.querySelector("input[name='listing-bid']").value);S(f,i,{amount:u})}),d.remove(),e.classList.remove("hidden"),e.classList.add("flex")}export{q as default};
