import{i as w,d as C,a as B,B as E,c as k,f as A,b as $,j as S}from"./app-CfEDMwqF.js";import{g as U,p as j}from"./bid-DuYU8mgh.js";import{g as F}from"./getFromUrl-l7KgJi7t.js";import"./errorMessage-IHW2CCLv.js";async function N({id:e,_seller:n=!0,_bids:i=!0}){const r=new URL(`${w}/${e}`);n&&r.searchParams.append("_seller",n),i&&r.searchParams.append("_bids","true");try{return(await C(r)).data}catch(a){console.error("Fetching error:",a.message)}}function P(e){const n=new Date(e),i={year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return n.toLocaleString("no-NO",i).replace(",","")}function I(e){const n=e.created;return P(n)}async function _(e){const n=document.getElementById("listing-title");n.innerText=e.title;const i=document.getElementById("listing-img");U(e,i);const r=document.getElementById("listing-seller-link");B?r.href=`${E}profile/index.html?name=${e.seller.name}`:(r.href="#",r.addEventListener("click",s=>{s.preventDefault(),alert("You must be logged in to view profiles.")}));const a=document.getElementById("listing-seller-avatar");a.src=e.seller?.avatar?.url,a.alt=e.seller?.avatar?.alt||e.seller?.avatar?.url;const o=document.getElementById("listing-seller");o.innerText=e.seller.name;const l=document.getElementById("listing-description");l.innerText=e.description;const p=document.getElementById("auction-expiry");p.innerText=k(e.endsAt);const d=A(e),u=document.getElementById("listing-current-bid");u.innerText=d.amount;const x=document.getElementById("listing-current-bidder");x.innerText=d.bidder.name;const g=document.getElementById("listing-current-bidder-link");if(e.bids.length<1){const s=document.getElementById("listing-no-bids");s.innerText="No bids yet!",u.innerText=""}if(e.bids.length!==0){const s=document.getElementById("listing-current-bidder-avatar");s.src=d.bidder.avatar.url,s.alt=d.bidder.avatar.alt||d.bidder.avatar.url,B?g.href=`${E}profile/index.html?name=${d.bidder.name}`:(g.href="#",g.addEventListener("click",t=>{t.preventDefault(),alert("You must be logged in to view profiles.")}));const h=document.getElementById("listing-current-bid-date");h.innerText=I(d)}else g.classList.add("hidden");const T=document.getElementById("listing-bids-container");if(e.bids.length>1){const s=document.getElementById("listing-bids-details");s.classList.remove("hidden"),s.classList.add("flex"),e.bids.sort((t,m)=>m.amount-t.amount).forEach(t=>{const m=document.createElement("div");m.classList.add("flex","items-center","justify-between");const b=document.createElement("p");b.classList.add("font-semibold"),b.innerText=t.amount;const c=document.createElement("a");c.classList.add("flex","items-center","gap-3"),B?c.href=`${E}profile/index.html?name=${t.bidder.name}`:(c.href="#",c.addEventListener("click",D=>{D.preventDefault(),alert("You must be logged in to view profiles.")}));const v=document.createElement("div");v.classList.add("w-8","h-8","rounded-full","bg-gray-300","overflow-hidden");const f=document.createElement("img");f.classList.add("w-full","h-full","object-cover"),f.src=t.bidder.avatar.url,f.alt=t.bidder.avatar.alt||t.bidder.avatar.url,v.append(f);const y=document.createElement("p");y.classList.add("font-semibold"),y.innerText=t.bidder.name,c.append(v,y);const L=document.createElement("p");L.innerText=I(t),m.append(b,c,L),T.append(m)})}}async function G(){const e=document.getElementById("listing-content"),n=document.querySelector("main"),i=$();n.append(i);const r=F(),a=await N({id:r});document.title=`${a.title} | HammerPrice`,_(a);const o=document.forms.placeBid,l=S();l?l&&a.seller.name===l.name&&o.classList.add("hidden"):o.classList.add("hidden"),o.addEventListener("submit",p=>{const d=a.id,u=parseFloat(document.querySelector("input[name='listing-bid']").value);j(p,d,{amount:u})}),i.remove(),e.classList.remove("hidden"),e.classList.add("flex")}export{G as default};
