import{j as T,d as D,a as y,c as w,f as k,b as C,s as $,k as A,h as S}from"./app-C8hg9oQH.js";import{g as j,p as F}from"./bid-vNrRaDYm.js";import{g as N}from"./getFromUrl-l7KgJi7t.js";async function P({id:e,_seller:a=!0,_bids:d=!0}){const t=new URL(`${T}/${e}`);a&&t.searchParams.append("_seller",a),d&&t.searchParams.append("_bids","true");try{return(await D(t)).data}catch(n){console.error("Fetching error:",n.message)}}function U(e){const a=new Date(e),d={year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return a.toLocaleString("no-NO",d).replace(",","")}function L(e){const a=e.created;return U(a)}async function Y(e){const a=document.getElementById("listing-title");a.innerText=e.title;const d=document.getElementById("listing-img");j(e,d);const t=document.getElementById("listing-seller-link");t.href=`/profile/index.html?name=${e.seller.name}`,y?t.href=`/profile/index.html?name=${e.seller.name}`:(t.href="#",t.addEventListener("click",r=>{r.preventDefault(),alert("You must be logged in to view profiles.")}));const n=document.getElementById("listing-seller-avatar");n.src=e.seller?.avatar?.url,n.alt=e.seller?.avatar?.alt||e.seller?.avatar?.url;const o=document.getElementById("listing-seller");o.innerText=e.seller.name;const l=document.getElementById("listing-description");l.innerText=e.description;const f=document.getElementById("auction-expiry");f.innerText=w(e.endsAt);const i=k(e),u=document.getElementById("listing-current-bid");u.innerText=i.amount;const B=document.getElementById("listing-current-bidder");B.innerText=i.bidder.name;const m=document.getElementById("listing-current-bidder-link");if(y?m.href=`/profile/index.html?name=${i.bidder.name}`:(m.href="#",m.addEventListener("click",r=>{r.preventDefault(),alert("You must be logged in to view profiles.")})),e.bids.length<1){const r=document.getElementById("listing-no-bids");r.innerText="No bids yet!",u.innerText=""}if(e.bids.length!==0){const r=document.getElementById("listing-current-bidder-avatar");r.src=i.bidder.avatar.url,r.alt=i.bidder.avatar.alt||i.bidder.avatar.url,m.href=`/profile/index.html?name=${i.bidder.name}`;const s=document.getElementById("listing-current-bid-date");s.innerText=L(i)}else m.classList.add("hidden");const x=document.getElementById("listing-bids-container");if(e.bids.length>1){const r=document.getElementById("listing-bids-details");r.classList.remove("hidden"),r.classList.add("flex"),e.bids.forEach(s=>{const p=document.createElement("div");p.classList.add("flex","items-center","justify-between");const b=document.createElement("p");b.classList.add("font-semibold"),b.innerText=s.amount;const c=document.createElement("a");c.classList.add("flex","items-center","gap-3"),y?c.href=`/profile/index.html?name=${s.bidder.name}`:(c.href="#",c.addEventListener("click",I=>{I.preventDefault(),alert("You must be logged in to view profiles.")}));const h=document.createElement("div");h.classList.add("w-8","h-8","rounded-full","bg-gray-300","overflow-hidden");const g=document.createElement("img");g.classList.add("w-full","h-full","object-cover"),g.src=s.bidder.avatar.url,g.alt=s.bidder.avatar.alt||s.bidder.avatar.url,h.append(g);const v=document.createElement("p");v.classList.add("font-semibold"),v.innerText=s.bidder.name,c.append(h,v);const E=document.createElement("p");E.innerText=L(s),p.append(b,c,E),x.append(p)})}}async function _(){const e=document.getElementById("listing-content"),a=document.querySelector("main"),d=C();a.append(d),$(d);const t=N(),n=await P({id:t});console.log(n),document.title=`${n.title} | HammerPrice`,Y(n);const o=document.forms.placeBid,l=A();l?l&&n.seller.name===l.name&&o.classList.add("hidden"):o.classList.add("hidden"),o.addEventListener("submit",f=>{const i=n.id,u=parseFloat(document.querySelector("input[name='listing-bid']").value);F(f,i,{amount:u})}),S(d),e.classList.remove("hidden"),e.classList.add("flex")}_();
