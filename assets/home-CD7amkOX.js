import{l as E,f as B,c as M,g as L,a as H,b as A}from"./app-CfEDMwqF.js";import{g as D,p as j}from"./bid-DuYU8mgh.js";import"./errorMessage-IHW2CCLv.js";function y(a,t){a.forEach(e=>{const s=document.createElement("div");s.classList.add("flex","flex-col","gap-3","shrink-0","w-80","cursor-pointer"),s.onclick=function(){E(e)};const i=document.createElement("div");i.classList.add("overflow-hidden","w-full","h-80");const n=document.createElement("img");if(n.classList.add("w-full","h-full","object-cover"),Array.isArray(e.media)&&e.media.length>0){const u=e.media[0];n.src=u.url||"https://images.unsplash.com/photo-1602052793312-b99c2a9ee797?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",n.alt=u.alt||u.url||"Example image"}else n.src="https://images.unsplash.com/photo-1602052793312-b99c2a9ee797?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",n.alt="Example image";const c=document.createElement("div"),o=document.createElement("h3");o.innerHTML=e.title;const d=document.createElement("p");d.innerHTML="Current bid: ";const l=document.createElement("span");l.innerHTML=B(e).amount,l.classList.add("font-semibold"),d.appendChild(l);const m=document.createElement("p");m.innerHTML=M(e.endsAt),c.append(o,d),i.appendChild(n),s.append(i,c,m),t.appendChild(s)})}async function k(){try{const a=await L();return!a||a.length===0?null:a.reduce((e,s)=>{const i=s._count?.bids||0,n=e._count?.bids||0;return i>n?s:e})}catch(a){throw console.error("Error fetching listings:",a.message),a}}async function I(a){const t=await k(),e=document.createElement("section");e.classList.add("flex","flex-col","lg:flex-row","h-full","gap-10","z-10","regular-padding","bg-transparent");const s=document.createElement("div");s.classList.add("flex-[1]","w-full","overflow-hidden","cursor-pointer"),s.onclick=function(){E(t)},D(t,s);const i=document.createElement("div");i.classList.add("flex-[1]","w-full","flex","flex-col","justify-between","gap-3");const n=document.createElement("div");n.classList.add("flex","flex-col","gap-3","cursor-pointer"),n.onclick=function(){E(t)};const c=document.createElement("h2");c.classList.add("truncate"),c.innerText=t.title;const o=document.createElement("p");o.innerText=M(t.endsAt);const d=document.createElement("p");d.classList.add("truncate"),d.innerText=t.description;const l=document.createElement("div");l.classList.add("flex","flex-col","gap-3");const m=document.createElement("div");m.classList.add("flex","items-center","justify-between");const u=document.createElement("p");u.innerText=t._count.bids+" bids";const g=document.createElement("p"),x=document.createElement("span");x.classList.add("font-semibold"),g.innerText="Current bid: ",x.innerText=B(t).amount,g.appendChild(x),m.append(u,g);const p=document.createElement("form");p.name="placeBid",p.classList.add("flex","flex-col","md:flex-row","items-center","gap-3","w-full"),H||p.classList.add("hidden");const h=document.createElement("div");h.classList.add("w-full","flex","justify-center","md:justify-end");const b=document.createElement("label");b.classList.add("hidden"),b.htmlFor="bid-amount";const r=document.createElement("input");r.id="bid-amount",r.classList.add("w-full","sm:w-1/2","md:w-auto"),r.name="bid-amount",r.type="number",r.placeholder="Enter amount",h.append(b,r);const f=document.createElement("button");f.innerText="Make bid",f.classList.add("w-full","sm:w-1/2","md:w-auto","btn","min-w-32"),f.type="submit",f.addEventListener("click",C=>{C.preventDefault();const v=t.id,T=parseFloat(r.value);j(C,v,{amount:T})});const w=document.createElement("p");w.id="error-message",w.classList.add("h-6","self-center","md:self-end"),p.append(h,f),l.append(m,p,w),n.append(c,o,d),i.append(n,l),e.append(s,i),a.appendChild(e)}async function q(){const a=document.querySelector("main"),t=A(),e=document.getElementById("home-content"),s=document.getElementById("hottest-listing"),i=document.getElementById("latest-listings"),n=document.getElementById("expiring-listings");a.appendChild(t),await I(s);const c=await L({limit:12});await y(c,i);const o=await L({sort:"endsAt",sortOrder:"asc",limit:12});await y(o,n),e.classList.remove("hidden"),e.classList.add("flex"),t.remove()}export{q as default};
