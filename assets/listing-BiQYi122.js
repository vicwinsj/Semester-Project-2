import{i as D,d as w,G as p,a as y,c as $,f as C,b as k,j as A}from"./app-X34734HY.js";import{g as S,p as j}from"./bid-Drh_Pq1k.js";import{g as F}from"./getFromUrl-l7KgJi7t.js";async function N({id:e,_seller:n=!0,_bids:a=!0}){const t=new URL(`${D}/${e}`);n&&t.searchParams.append("_seller",n),a&&t.searchParams.append("_bids","true");try{return(await w(t)).data}catch(r){console.error("Fetching error:",r.message)}}function P(e){const n=new Date(e),a={year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return n.toLocaleString("no-NO",a).replace(",","")}function L(e){const n=e.created;return P(n)}async function U(e){const n=document.getElementById("listing-title");n.innerText=e.title;const a=document.getElementById("listing-img");S(e,a);const t=document.getElementById("listing-seller-link");t.href=`${p}/profile/index.html?name=${e.seller.name}`,y?t.href=`${p}/profile/index.html?name=${e.seller.name}`:(t.href="#",t.addEventListener("click",d=>{d.preventDefault(),alert("You must be logged in to view profiles.")}));const r=document.getElementById("listing-seller-avatar");r.src=e.seller?.avatar?.url,r.alt=e.seller?.avatar?.alt||e.seller?.avatar?.url;const o=document.getElementById("listing-seller");o.innerText=e.seller.name;const l=document.getElementById("listing-description");l.innerText=e.description;const b=document.getElementById("auction-expiry");b.innerText=$(e.endsAt);const i=C(e),u=document.getElementById("listing-current-bid");u.innerText=i.amount;const x=document.getElementById("listing-current-bidder");x.innerText=i.bidder.name;const g=document.getElementById("listing-current-bidder-link");if(e.bids.length<1){const d=document.getElementById("listing-no-bids");d.innerText="No bids yet!",u.innerText=""}if(e.bids.length!==0){const d=document.getElementById("listing-current-bidder-avatar");d.src=i.bidder.avatar.url,d.alt=i.bidder.avatar.alt||i.bidder.avatar.url,y?g.href=`${p}/profile/index.html?name=${i.bidder.name}`:(g.href="#",g.addEventListener("click",m=>{m.preventDefault(),alert("You must be logged in to view profiles.")}));const s=document.getElementById("listing-current-bid-date");s.innerText=L(i)}else g.classList.add("hidden");const I=document.getElementById("listing-bids-container");if(e.bids.length>1){const d=document.getElementById("listing-bids-details");d.classList.remove("hidden"),d.classList.add("flex"),e.bids.forEach(s=>{const m=document.createElement("div");m.classList.add("flex","items-center","justify-between");const v=document.createElement("p");v.classList.add("font-semibold"),v.innerText=s.amount;const c=document.createElement("a");c.classList.add("flex","items-center","gap-3"),y?c.href=`${p}/profile/index.html?name=${s.bidder.name}`:(c.href="#",c.addEventListener("click",T=>{T.preventDefault(),alert("You must be logged in to view profiles.")}));const h=document.createElement("div");h.classList.add("w-8","h-8","rounded-full","bg-gray-300","overflow-hidden");const f=document.createElement("img");f.classList.add("w-full","h-full","object-cover"),f.src=s.bidder.avatar.url,f.alt=s.bidder.avatar.alt||s.bidder.avatar.url,h.append(f);const E=document.createElement("p");E.classList.add("font-semibold"),E.innerText=s.bidder.name,c.append(h,E);const B=document.createElement("p");B.innerText=L(s),m.append(v,c,B),I.append(m)})}}async function q(){const e=document.getElementById("listing-content"),n=document.querySelector("main"),a=k();n.append(a);const t=F(),r=await N({id:t});document.title=`${r.title} | HammerPrice`,U(r);const o=document.forms.placeBid,l=A();l?l&&r.seller.name===l.name&&o.classList.add("hidden"):o.classList.add("hidden"),o.addEventListener("submit",b=>{const i=r.id,u=parseFloat(document.querySelector("input[name='listing-bid']").value);j(b,i,{amount:u})}),a.remove(),e.classList.remove("hidden"),e.classList.add("flex")}export{q as default};
